#@type:grammar;@schema:procedure;
JOB_EVAL_LOGIC{

PRECONDITION: JOB_EVAL_REQUESTED

ACTION:
	IF !JOB_POSTING_PRESENT -> EMIT_CHAT "DDD:INLINE: Missing job posting input (link, text, or PDF).";
	IF !JOB_POSTING_PRESENT -> HALT;

	SET "RESUME_ENUM=GOV|ALN|ALGOV|RSR|OPS|PUX|PASS";

	SET "RESUME_FILENAME_MAP={
		GOV:'Max_Sweet_AI_Governance_Resume.pdf',
		ALN:'Max_Sweet_AI_Alignment_Resume.pdf',
		ALGOV:'Max_Sweet_AI_Alignment_Governance_Resume.pdf',
		RSR:'Max_Sweet_AI_Research_Alignment_Resume.pdf',
		OPS:'Max_Sweet_AI_Operations_Resume.pdf',
		PUX:'Max_Sweet_Prompt_UX_Resume.pdf'
	}";

	SET "ROLE_SIGNALS={
		ROLE_FAMILY:CONVERSATIONAL_DESIGN|UX_PROMPT|CONTENT_DESIGN|UX_GENERAL|GOVERNANCE|ALIGNMENT|ALIGNMENT_GOVERNANCE|RESEARCH_ALIGNMENT|OPERATIONS|OTHER,
		MODALITY:CHAT|VOICE|MULTIMODAL|UNKNOWN,
		DELIVERABLES:intents_utterances_slots|flow_diagrams|transcript_analysis|prompt_specs|eval_frameworks|policy_sops|prototypes|other,
		COLLAB:product|engineering|legal|accessibility|ux|architecture|other,
		CONTRACT_TYPE:FULL_TIME|CONTRACT|UNKNOWN,
		LOCATION_MODE:REMOTE|HYBRID|ONSITE|UNKNOWN,
		TIMEZONE_REQ:EST|CST|MST|PST|ANY|UNKNOWN,
		ENGAGEMENT_MODEL:CONSULTING|INTERNAL|UNKNOWN,
		SCOPE_SHAPE:BOUNDED|UNBOUNDED|UNKNOWN
	}";

	SET "CAPABILITY_WEAKNESSES={
		ML_STACKS,
		PYTHON_HEAVY_BACKENDS,
		C_CPP_SYSTEMS,
		NON_SQL_DATABASES
	}";

	SET "RESUME_COVERAGE_MAP={
		CONVERSATIONAL_DESIGN:STRONG,
		UX_PROMPT:STRONG,
		CONTENT_DESIGN:MEDIUM,
		UX_GENERAL:MEDIUM,
		GOVERNANCE:STRONG,
		ALIGNMENT:STRONG,
		ALIGNMENT_GOVERNANCE:STRONG,
		RESEARCH_ALIGNMENT:STRONG,
		OPERATIONS:STRONG,
		OTHER:WEAK
	}";

	SET "RESUME_SELECTION_RULES={
		ROLE_FAMILY_CONVERSATIONAL_DESIGN:'PUX',
		ROLE_FAMILY_UX_PROMPT:'PUX',
		ROLE_FAMILY_CONTENT_DESIGN:'PUX',
		ROLE_FAMILY_UX_GENERAL:'PUX',
		ROLE_FAMILY_GOVERNANCE:'GOV',
		ROLE_FAMILY_ALIGNMENT:'ALN',
		ROLE_FAMILY_ALIGNMENT_GOVERNANCE:'ALGOV',
		ROLE_FAMILY_RESEARCH_ALIGNMENT:'RSR',
		ROLE_FAMILY_OPERATIONS:'OPS',
		ROLE_FAMILY_OTHER:'PASS'
	}";

	SET "DIAL_DEFAULTS={
		EFFORT_LEVEL:MEDIUM,
		OPPORTUNITY_COST:LOW,
		ROLE_LONGEVITY:UNKNOWN,
		STRATEGIC_ALIGNMENT:MEDIUM,
		REPUTATIONAL_VOLATILITY:LOW,
		PERSONAL_VALUES_FRICTION:LOW,
		FINANCIAL_UTILITY:MEDIUM,
		RESUME_SCORE:0.50
	}";

	SET "WEIGHTS={
		STRATEGIC_ALIGNMENT:0.25,
		ROLE_LONGEVITY:0.20,
		OPPORTUNITY_COST:0.20,
		PERSONAL_VALUES_FRICTION:0.15,
		REPUTATIONAL_VOLATILITY:0.10,
		EFFORT_LEVEL:0.05,
		FINANCIAL_UTILITY:0.05
	}";

	SET "ENUM_MAP={HIGH:1.0,MEDIUM:0.5,LOW:0.0}";
	SET "NEGATIVE_ENUM_MAP={LOW:1.0,MEDIUM:0.5,HIGH:0.0}";
	SET "OPPORTUNITY_COST_MAP={NONE:1.0,LOW:0.5,HIGH:0.0}";
	SET "ROLE_LONGEVITY_MAP={LONG_TERM:1.0,UNKNOWN:0.5,TEMPORARY:0.0}";
	SET "EFFORT_LEVEL_MAP={ZERO:1.0,LOW:0.75,MEDIUM:0.40,HIGH:0.0}";

	IF !ROLE_REQUIRES_PRESENT -> SET "ROLE_REQUIRES={}";

	IF !TECH_FRICTION_PRESENT -> SET "TECH_FRICTION=NONE";

	IF INTERSECTS(ROLE_REQUIRES,CAPABILITY_WEAKNESSES) == TRUE -> SET "TECH_FRICTION=HIGH";
	IF TECH_FRICTION == HIGH -> EMIT_CHAT "Note: Role requires technologies outside core strengths (non-blocking but increases effort/risk).";

	IF !WORKFLOW_REGULATION_MODE_PRESENT -> SET "WORKFLOW_REGULATION_MODE=SELF_DIRECTED";
	IF !STRATEGY_MODE_PRESENT -> SET "STRATEGY_MODE=DEFAULT";
	IF !ENGAGEMENT_MODEL_PRESENT -> SET "ENGAGEMENT_MODEL=UNKNOWN";
	IF !SCOPE_SHAPE_PRESENT -> SET "SCOPE_SHAPE=UNKNOWN";

	IF MISSING_REQUIRED_INPUTS -> SET "USE_DEFAULTS=TRUE";
	IF USE_DEFAULTS == TRUE -> EMIT_CHAT "DDD:INLINE: Some dial inputs missing; applying defaults.";

	IF USE_DEFAULTS == TRUE -> SET "EFFORT_LEVEL=DIAL_DEFAULTS.EFFORT_LEVEL";
	IF USE_DEFAULTS == TRUE -> SET "OPPORTUNITY_COST=DIAL_DEFAULTS.OPPORTUNITY_COST";
	IF USE_DEFAULTS == TRUE -> SET "ROLE_LONGEVITY=DIAL_DEFAULTS.ROLE_LONGEVITY";
	IF USE_DEFAULTS == TRUE -> SET "STRATEGIC_ALIGNMENT=DIAL_DEFAULTS.STRATEGIC_ALIGNMENT";
	IF USE_DEFAULTS == TRUE -> SET "REPUTATIONAL_VOLATILITY=DIAL_DEFAULTS.REPUTATIONAL_VOLATILITY";
	IF USE_DEFAULTS == TRUE -> SET "PERSONAL_VALUES_FRICTION=DIAL_DEFAULTS.PERSONAL_VALUES_FRICTION";
	IF USE_DEFAULTS == TRUE -> SET "FINANCIAL_UTILITY=DIAL_DEFAULTS.FINANCIAL_UTILITY";
	IF USE_DEFAULTS == TRUE -> SET "RESUME_SCORE=DIAL_DEFAULTS.RESUME_SCORE";

	IF !CONTRACT_MONTHS_PRESENT -> SET "CONTRACT_MONTHS=0";

	IF CONTRACT_MONTHS>0 AND CONTRACT_MONTHS<=12 -> SET "ROLE_LONGEVITY=TEMPORARY";
	IF CONTRACT_MONTHS>12 AND CONTRACT_MONTHS<24 -> SET "ROLE_LONGEVITY=UNKNOWN";
	IF CONTRACT_MONTHS>=24 -> SET "ROLE_LONGEVITY=LONG_TERM";

	IF WORKFLOW_REGULATION_MODE == EXTERNALLY_REGULATED AND ENGAGEMENT_MODEL == CONSULTING AND SCOPE_SHAPE == BOUNDED AND EFFORT_LEVEL == HIGH -> SET "EFFORT_LEVEL=MEDIUM";
	IF WORKFLOW_REGULATION_MODE == EXTERNALLY_REGULATED AND ENGAGEMENT_MODEL == CONSULTING AND SCOPE_SHAPE == BOUNDED AND EFFORT_LEVEL == MEDIUM -> SET "EFFORT_LEVEL=LOW";

	IF WORKFLOW_REGULATION_MODE == EXTERNALLY_REGULATED AND ENGAGEMENT_MODEL == INTERNAL AND SCOPE_SHAPE == UNBOUNDED AND EFFORT_LEVEL == LOW -> SET "EFFORT_LEVEL=MEDIUM";
	IF WORKFLOW_REGULATION_MODE == EXTERNALLY_REGULATED AND ENGAGEMENT_MODEL == INTERNAL AND SCOPE_SHAPE == UNBOUNDED AND EFFORT_LEVEL == MEDIUM -> SET "EFFORT_LEVEL=HIGH";

	IF STRATEGY_MODE == NETWORK_TIME_BOUNDED AND ROLE_LONGEVITY == TEMPORARY -> SET "ROLE_LONGEVITY=UNKNOWN";

	IF DISPLACES_EXISTING_APP == TRUE AND OPPORTUNITY_COST!=HIGH -> ERROR "OPPORTUNITY_COST must be HIGH when DISPLACES_EXISTING_APP is TRUE";
	IF DISPLACES_EXISTING_APP == TRUE AND OPPORTUNITY_COST!=HIGH -> HALT;

	SET "W_STRATEGIC_ALIGNMENT=ENUM_MAP[STRATEGIC_ALIGNMENT]";
	SET "W_ROLE_LONGEVITY=ROLE_LONGEVITY_MAP[ROLE_LONGEVITY]";
	SET "W_OPPORTUNITY_COST=OPPORTUNITY_COST_MAP[OPPORTUNITY_COST]";
	SET "W_PERSONAL_VALUES_FRICTION=NEGATIVE_ENUM_MAP[PERSONAL_VALUES_FRICTION]";
	SET "W_REPUTATIONAL_VOLATILITY=NEGATIVE_ENUM_MAP[REPUTATIONAL_VOLATILITY]";

	SET "W_EFFORT_LEVEL=EFFORT_LEVEL_MAP[EFFORT_LEVEL]";
	SET "W_FINANCIAL_UTILITY=ENUM_MAP[FINANCIAL_UTILITY]";

	SET "WORTH_SCORE=
		(W_STRATEGIC_ALIGNMENT*0.25) +
		(W_ROLE_LONGEVITY*0.20) +
		(W_OPPORTUNITY_COST*0.20) +
		(W_PERSONAL_VALUES_FRICTION*0.15) +
		(W_REPUTATIONAL_VOLATILITY*0.10) +
		(W_EFFORT_LEVEL*0.05) +
		(W_FINANCIAL_UTILITY*0.05)
	";

	SET "WORTH_SCORE=ROUND_HALF_UP_PRIMITIVE(WORTH_SCORE,2)";
	IF WORTH_SCORE<0.00 -> SET "WORTH_SCORE=0.00";
	IF WORTH_SCORE>1.00 -> SET "WORTH_SCORE=1.00";

	IF WORTH_SCORE>=0.75 -> SET "WORTH_VERDICT=STRATEGIC_YES";
	IF WORTH_SCORE>=0.60 AND WORTH_SCORE<0.75 -> SET "WORTH_VERDICT=LOW_FRICTION_ONLY";
	IF WORTH_SCORE<0.60 -> SET "WORTH_VERDICT=DO_NOT_SUBMIT";

	SET "WORTH_SCORE_PCT_RAW=WORTH_SCORE*100";
	SET "WORTH_SCORE_PCT=TO_INT_PRIMITIVE(ROUND_HALF_UP_PRIMITIVE(WORTH_SCORE_PCT_RAW,0))";

	SET "GATE_WORTH_CLOSED=(WORTH_VERDICT == DO_NOT_SUBMIT)";
	SET "COVERAGE=RESUME_COVERAGE_MAP[ROLE_FAMILY]";
	SET "COVERAGE_GAP=(COVERAGE == WEAK)";
	SET "RECOMMENDED_RESUME_ENUM=RESUME_SELECTION_RULES['ROLE_FAMILY_' + ROLE_FAMILY]";
	SET "GATE_RESUME_CLOSED=(RECOMMENDED_RESUME_ENUM == PASS)";

	SET "FINAL_DECISION=APPLY";
	IF GATE_WORTH_CLOSED == TRUE AND USER_OVERRIDE_APPLY_ANYWAY!=TRUE -> SET "FINAL_DECISION=PASS";
	IF FINAL_DECISION!=PASS AND (COVERAGE_GAP == TRUE OR GATE_RESUME_CLOSED == TRUE) AND USER_OVERRIDE_APPLY_ANYWAY!=TRUE -> SET "FINAL_DECISION=PASS";

	IF FINAL_DECISION == PASS AND GATE_WORTH_CLOSED == TRUE -> SET "PASS_REASON=Gate closed (DO_NOT_SUBMIT).";
	IF FINAL_DECISION == PASS AND GATE_WORTH_CLOSED!=TRUE AND (COVERAGE_GAP == TRUE OR GATE_RESUME_CLOSED == TRUE) -> SET "PASS_REASON=Resume coverage gap (resume inventory framing mismatch).";

	IF USER_OVERRIDE_APPLY_ANYWAY == TRUE -> SET "FINAL_DECISION=APPLY";

	IF FINAL_DECISION == PASS -> EMIT_CHAT "Decision: PASS";
	IF FINAL_DECISION == PASS -> EMIT_CHAT "Reason: {PASS_REASON}";

	IF FINAL_DECISION == APPLY -> SET "RECOMMENDED_RESUME_FILENAME=RESUME_FILENAME_MAP[RECOMMENDED_RESUME_ENUM]";
	IF FINAL_DECISION == APPLY -> EMIT_CHAT "Decision: APPLY";
	IF FINAL_DECISION == APPLY -> EMIT_CHAT "Recommended Resume: {RECOMMENDED_RESUME_FILENAME}";

	SET "RESUME_POS=CLAMP(ROUND_HALF_UP_PRIMITIVE(RESUME_SCORE*10),1,10)";
	SET "WORTH_POS=CLAMP(ROUND_HALF_UP_PRIMITIVE(WORTH_SCORE*10),1,10)";
	SET "BAR_RESUME=REPEAT_PRIMITIVE('▯',RESUME_POS-1) + '▮' + REPEAT_PRIMITIVE('▯',10-RESUME_POS)";
	SET "BAR_WORTH=REPEAT_PRIMITIVE('▯',WORTH_POS-1) + '▮' + REPEAT_PRIMITIVE('▯',10-WORTH_POS)";

	SET "RESUME_ACTION=Enhance a Base";
	IF RESUME_POS>=1 AND RESUME_POS<=3 -> SET "RESUME_ACTION=Use a Base";
	IF RESUME_POS>=4 AND RESUME_POS<=6 -> SET "RESUME_ACTION=Enhanced Base Suggested";
	IF RESUME_POS>=7 AND RESUME_POS<=8 -> SET "RESUME_ACTION=Worth Discussing Enhanced Base verse Bespoke";
	IF RESUME_POS>=9 AND RESUME_POS<=10 -> SET "RESUME_ACTION=Use Bespoke";

	SET "FRICTION_SOURCE=GENERAL";
	SET "FRICTION_LABEL=General";

	IF RESUME_POS>=7 -> SET "FRICTION_SOURCE=FRAMING";
	IF RESUME_POS>=7 -> SET "FRICTION_LABEL=Résumé Framing";

	IF FRICTION_SOURCE==GENERAL AND LOCATION_MODE==ONSITE -> SET "FRICTION_SOURCE=LOGISTICS";
	IF FRICTION_SOURCE==GENERAL AND LOCATION_MODE==ONSITE -> SET "FRICTION_LABEL=Onsite Travel Logistics";
	IF FRICTION_SOURCE==GENERAL AND LOCATION_MODE==HYBRID -> SET "FRICTION_SOURCE=LOGISTICS";
	IF FRICTION_SOURCE==GENERAL AND LOCATION_MODE==HYBRID -> SET "FRICTION_LABEL=Hybrid Travel Logistics";

	IF FRICTION_SOURCE==GENERAL AND EFFORT_LEVEL==HIGH -> SET "FRICTION_SOURCE=EXECUTION";
	IF FRICTION_SOURCE==GENERAL AND EFFORT_LEVEL==HIGH -> SET "FRICTION_LABEL=High Interviewing Effort";

	IF FRICTION_SOURCE==GENERAL AND OPPORTUNITY_COST==HIGH -> SET "FRICTION_SOURCE=OPPORTUNITY";
	IF FRICTION_SOURCE==GENERAL AND OPPORTUNITY_COST==HIGH -> SET "FRICTION_LABEL=High Opportunity Cost";

	SET "WORTH_VERDICT_CHAT=WORTH_VERDICT";
	IF WORTH_VERDICT == STRATEGIC_YES -> SET "WORTH_VERDICT_CHAT=Strong submit";
	IF WORTH_VERDICT == LOW_FRICTION_ONLY -> SET "WORTH_VERDICT_CHAT=Submit if the {FRICTION_LABEL} isn't an issue";
	IF WORTH_VERDICT == DO_NOT_SUBMIT -> SET "WORTH_VERDICT_CHAT=Do not submit";

	EMIT_CHAT "Pass [{BAR_WORTH}] Submit";
	EMIT_CHAT "Score: {WORTH_SCORE_PCT}%";
	EMIT_CHAT "Verdict: {WORTH_VERDICT_CHAT}";
	EMIT_CHAT "Resume Type Eval: [{BAR_RESUME}] {RESUME_ACTION}";

STATE:{
	PRECONDITION=JOB_EVAL_REQUESTED;
	OUTPUT_MODE=CHAT_ONLY;
	DIALS_ALWAYS_EMIT=TRUE;
	DIAL_BLOCK_LINES=4;
	DIAL_BLOCK_MUST_BE_LAST=TRUE;
	GATES=WORTH|COVERAGE;
	OVERRIDE_INPUT=USER_OVERRIDE_APPLY_ANYWAY;
	RESUME_ENUM_SET=GOV|ALN|ALGOV|RSR|OPS|PUX|PASS;
}
}
